<html>

<head>
<meta charset="utf-8">
<title>Test</title>
</head>

<body onload="brython(1)">

<h1 style="text-align: center">Brython tests</h1>

<div id="changetext">Sample Text</div>
<div id="changetext">Hello</div>

<div class="test" id="t1">
  <button id="button1">Click to change text</button>
  <script type ="text/python" id="script0">
  from browser import document

  from __future__ import print_function
  import datetime
  from googleapiclient.discovery import build
  from httplib2 import Http
  from oauth2client import file, client, tools
  document["changetext"].textContent = "No activity."
  # If modifying these scopes, delete the file token.json.
  SCOPES = 'https://www.googleapis.com/auth/activity'

  def main(ev):
  store = file.Storage('token.json')
  creds = store.get()
  if not creds or creds.invalid:
      flow = client.flow_from_clientsecrets('credentials.json', SCOPES)
      creds = tools.run_flow(flow, store)
  service = build('appsactivity', 'v1', http=creds.authorize(Http()))

  # Call the Drive Activity API
  results = service.activities().list(source='drive.google.com',
      drive_ancestorId='root', pageSize=10).execute()
  activities = results.get('activities', [])

  if not activities:
      document["changetext"].textContent = "No activity."
  else:
      document["changetext"].textContent = 'Recent activity:'
      for activity in activities:
          event = activity['combinedEvent']
          user = event.get('user', None)
          target = event.get('target', None)
          if user is None or target is None:
              continue
          time = datetime.datetime.fromtimestamp(
              int(event['eventTimeMillis'])/1000)
          document["changetext"].textContent = (u'{0}: {1}, {2}, {3} ({4})'.format(time, user['name'],
              event['primaryEventType'], target['name'], target['mimeType']))
  document["button1"].bind("click", main)
  </script>


<script src="brython.js"></script>
<script src="brython_stdlib.js"></script>

</body>

</html>
